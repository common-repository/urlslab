import{w as v,r as g,R as a,_ as d,x as M,N as w,y as S,z as C,S as f,V as n,I as h,W as A,aO as V,A as k,L as F,X as P,M as U,C as L,Y as q,E,aX as x,aP as D,aQ as H}from"../main-do863ioiri.js";import{h as m}from"./redirectsHeader-do863ioiri.js";const O=d("Add New Redirect","urlslab"),R="redirect_id",B={columnVisibility:{if_not_found:!1,is_logged:!1,capabilities:!1,ip:!1,roles:!1,browser:!1,cookie:!1,headers:!1,params:!1}};function G({slug:o}){const t=v(b=>b.setTable),[i,r]=g.useState(!1);return g.useEffect(()=>{r(!0),t(o,{title:O,paginationId:R,slug:o,header:m,id:"match_url"})},[t,o]),i&&a.createElement(T,{slug:o})}function T({slug:o}){const{columnHelper:t,data:i,isLoading:r,isSuccess:b,isFetchingNextPage:s,ref:N}=M({slug:o}),z=g.useMemo(()=>{var e;return(e=i==null?void 0:i.pages)==null?void 0:e.flatMap(l=>l??[])},[i==null?void 0:i.pages]),p=v(e=>e.setTable),{columnTypes:c,isLoadingColumnTypes:I}=w(o),{deleteRow:_,updateRow:u}=S(),y=g.useMemo(()=>c?[t.accessor("check",{className:"checkbox",cell:e=>a.createElement(C,{tableElement:e}),header:e=>a.createElement(C,{tableElement:e})}),t.accessor("match_type",{className:"nolimit",cell:e=>a.createElement(f,{autoClose:!0,items:c==null?void 0:c.match_type.values,name:e.column.id,value:e.getValue(),onChange:l=>u({newVal:l,cell:e})}),header:e=>a.createElement(n,{...e}),size:80}),t.accessor("match_url",{className:"nolimit",cell:e=>a.createElement(h,{value:e.getValue(),onChange:l=>u({newVal:l,cell:e})}),header:e=>a.createElement(n,{...e}),size:200}),t.accessor("replace_url",{className:"nolimit",cell:e=>a.createElement(h,{value:e.getValue(),onChange:l=>u({newVal:l,cell:e})}),header:e=>a.createElement(n,{...e}),size:200}),t.accessor("redirect_code",{className:"nolimit",cell:e=>a.createElement(f,{autoClose:!0,items:c==null?void 0:c.redirect_code.values,name:e.column.id,value:e.getValue(),onChange:l=>u({newVal:l,cell:e})}),header:e=>a.createElement(n,{...e}),size:100}),t.accessor("if_not_found",{className:"nolimit",cell:e=>a.createElement(f,{autoClose:!0,items:c==null?void 0:c.if_not_found.values,name:e.column.id,value:e.getValue(),onChange:l=>u({newVal:l,cell:e})}),header:e=>a.createElement(n,{...e}),size:100}),t.accessor("is_logged",{className:"nolimit",cell:e=>a.createElement(f,{autoClose:!0,items:c==null?void 0:c.is_logged.values,name:e.column.id,value:e.getValue(),onChange:l=>u({newVal:l,cell:e})}),header:e=>a.createElement(n,{...e}),size:100}),t.accessor("ip",{className:"nolimit",cell:e=>a.createElement(h,{value:e.getValue(),onChange:l=>u({newVal:l,cell:e})}),header:e=>a.createElement(n,{...e}),size:100,show:!1}),t.accessor("created",{cell:e=>a.createElement(A,{datetime:e.getValue()}),header:e=>a.createElement(n,{...e}),size:115,show:!1}),t.accessor("roles",{header:e=>a.createElement(n,{...e}),size:100}),t.accessor("capabilities",{className:"nolimit",header:e=>a.createElement(n,{...e}),size:100,show:!1}),t.accessor("browser",{className:"nolimit",cell:e=>a.createElement(h,{value:e.getValue(),onChange:l=>u({newVal:l,cell:e})}),header:e=>a.createElement(n,{...e}),size:100,show:!1}),t.accessor("cookie",{className:"nolimit",cell:e=>a.createElement(h,{value:e.getValue(),onChange:l=>u({newVal:l,cell:e})}),header:e=>a.createElement(n,{...e}),size:100}),t.accessor("headers",{className:"nolimit",cell:e=>a.createElement(h,{value:e.getValue(),onChange:l=>u({newVal:l,cell:e})}),header:e=>a.createElement(n,{...e}),size:100}),t.accessor("params",{className:"nolimit",cell:e=>a.createElement(h,{value:e.getValue(),onChange:l=>u({newVal:l,cell:e})}),header:e=>a.createElement(n,{...e}),size:100}),t.accessor("cnt",{header:e=>a.createElement(n,{...e}),size:100}),t.accessor("labels",{className:"nolimit",cell:e=>a.createElement(V,{value:e.getValue(),slug:o,onChange:l=>u({newVal:l,cell:e})}),header:m.labels,size:160}),t.accessor("editRow",{className:"editRow",cell:e=>a.createElement(k,{onEdit:()=>u({cell:e,id:"match_url"}),onDelete:()=>_({cell:e,id:"match_url"})}),header:()=>null,size:0})]:[],[t,c,_,o,u]);return g.useEffect(()=>{p(o,{data:i})},[i,p,o]),r||I?a.createElement(F,{isFullscreen:!0}):a.createElement(a.Fragment,null,a.createElement(P,{title:d("About this table","urlslab"),tableSlug:o,isMainTableDescription:!0},d("The table contains redirect rules that automatically guide visitors to your website when the outlined conditions are detected. These rules simplify the management of redirects, eliminating the need to manually alter the .htaccess file on your server. Redirect evaluations occur in PHP each time a visitor accesses a page. Importantly, our system does not modify your .htaccess file when changing rules.","urlslab")),a.createElement(U,null),a.createElement(L,{className:"fadeInto",initialState:B,columns:y,data:b&&z,referrer:N,loadingRows:s},a.createElement(q,null)),a.createElement(K,{slug:o}))}const K=g.memo(({slug:o})=>{const t=E(s=>s.setRowToEdit),i=E(s=>s.rowToEdit),{columnTypes:r}=w(o),b=g.useMemo(()=>({match_type:a.createElement(f,{defaultAccept:!0,autoClose:!0,items:r==null?void 0:r.match_type.values,name:"match_type",defaultValue:"E",onChange:s=>t({match_type:s})},m.match_type),match_url:a.createElement(h,{type:"url",autoFocus:!0,liveUpdate:!0,defaultValue:"",label:m.match_url,description:d("Match this value with the browser URL according to the selected rule type","urlslab"),onChange:s=>t({match_url:s}),required:!0}),replace_url:a.createElement(x,{suggestInput:(i==null?void 0:i.match_url)||"",showInputAsSuggestion:!0,liveUpdate:!0,defaultValue:window.location.origin,referenceVal:"match_url",description:d("If the browser URL and all other conditions match, redirect the user to this URL","urlslab"),label:m.replace_url,onChange:s=>t({replace_url:s}),required:!0}),redirect_code:a.createElement(f,{autoClose:!0,items:r==null?void 0:r.redirect_code.values,name:"redirect_code",defaultValue:"301",description:d("HTTP status code for visitor redirection","urlslab"),onChange:s=>t({redirect_code:s})},m.redirect_code),is_logged:a.createElement(f,{autoClose:!0,items:r==null?void 0:r.is_logged.values,name:"is_logged",defaultValue:"A",onChange:s=>t({is_logged:s})},m.is_logged),headers:a.createElement(h,{liveUpdate:!0,defaultValue:"",label:m.headers,description:d("Redirect only requests with specified HTTP headers sent from the browser. List the headers to be checked, separated by commas. For instance: HEADER-NAME, HEADER-NAME=value","urlslab"),onChange:s=>t({headers:s})}),cookie:a.createElement(h,{liveUpdate:!0,defaultValue:"",label:m.cookie,description:d("Redirect only requests with specified cookie sent from the browser. List the cookies to be checked, separated by commas. For instance: COOKIE_NAME, COOKIE_NAME=value","urlslab"),onChange:s=>t({cookie:s})}),params:a.createElement(h,{liveUpdate:!0,defaultValue:"",label:m.params,description:d("Redirect only requests with specified GET or POST parameter. List the parameters to be checked, separated by commas. For instance: query-param, query-param=value","urlslab"),onChange:s=>t({params:s})}),roles:a.createElement(D,{defaultValue:"",description:d("Redirect only requests from users with particular roles","urlslab"),onChange:s=>t({roles:s})}),capabilities:a.createElement(H,{key:i.roles,defaultValue:"",description:d("Redirect only requests from users with certain capabilities","urlslab"),onChange:s=>t({capabilities:s})}),ip:a.createElement(h,{liveUpdate:!0,defaultValue:"",label:m.ip,description:d("Redirect only visitors from certain IP addresses or subnets. Provide a comma-separated list of IP addresses or subnets. For instance: 172.120.0.*, 192.168.0.0/24","urlslab"),onChange:s=>t({ip:s})}),browser:a.createElement(h,{liveUpdate:!0,defaultValue:"",label:m.browser,description:d("Redirect visitors using specific browsers. Input browser names or any string from User-Agent, separated by commas","urlslab"),onChange:s=>t({browser:s})}),if_not_found:a.createElement(f,{autoClose:!0,items:r==null?void 0:r.if_not_found.values,name:"if_not_found",defaultValue:"A",onChange:s=>t({if_not_found:s})},m.if_not_found),labels:a.createElement(V,{optionItem:!0,label:d("Tags:","urlslab"),slug:o,onChange:s=>t({labels:s})})}),[r==null?void 0:r.match_type.values,r==null?void 0:r.redirect_code.values,r==null?void 0:r.is_logged.values,r==null?void 0:r.if_not_found.values,i==null?void 0:i.match_url,i.roles,o,t]);g.useEffect(()=>{E.setState(()=>({...E.getState(),rowEditorCells:b,deleteCSVCols:[R]}))},[b])});export{G as default};
