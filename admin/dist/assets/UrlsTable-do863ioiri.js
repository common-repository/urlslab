import{w as U,r as m,R as t,_ as a,x as W,E as f,N as L,y as Y,O as h,Q as b,U as E,z as A,ah as q,V as i,S as M,I as v,ai as w,bt as X,W as S,aO as N,A as j,B as G,L as J,X as Z,M as ee,C as te,Y as ae,k as F}from"../main-do863ioiri.js";const se="url_id",_={url_name:a("URL","urlslab"),url_title:a("Title","urlslab"),url_h1:a("H1 tag","urlslab"),url_meta_description:a("Description","urlslab"),url_summary:a("Summary","urlslab"),visibility:a("Visibility","urlslab"),url_priority:a("SEO rank","urlslab"),url_links_count:a("Outgoing links count","urlslab"),url_usage_cnt:a("Incoming links count","urlslab"),url_lang:a("Language","urlslab"),url_type:a("Type","urlslab"),http_status:a("HTTP status","urlslab"),content_type:a("Content Type","urlslab"),update_http_date:a("HTTP status change","urlslab"),scr_status:a("Screenshot status","urlslab"),update_scr_date:a("Screenshot status change","urlslab"),screenshot_usage_count:a("Screenshot usage","urlslab"),sum_status:a("Summary status","urlslab"),update_sum_date:a("Summary status change","urlslab"),rel_schedule:a("Related Articles","urlslab"),rel_updated:a("Related Articles Changed","urlslab"),attributes:a("Attributes","urlslab"),labels:a("Tags","urlslab")},re={columnVisibility:{url_h1:!1,url_meta_description:!1,url_lang:!1,update_http_date:!1,scr_status:!1,sum_status:!1,update_scr_date:!1,update_sum_date:!1,rel_schedule:!1,rel_updated:!1,attributes:!1,url_type:!1}};function ue({slug:l}){const s=U(o=>o.setTable),[u,p]=m.useState(!1);return m.useEffect(()=>{p(!0),s(l,{paginationId:se,slug:l,header:_})},[s,l]),u&&t.createElement(ne,{slug:l})}function ne({slug:l}){const{columnHelper:s,data:u,isLoading:p,isSuccess:o,isFetchingNextPage:P,ref:B}=W({slug:l}),O=m.useMemo(()=>{var e;return(e=u==null?void 0:u.pages)==null?void 0:e.flatMap(r=>r??[])},[u==null?void 0:u.pages]),z=U(e=>e.setTable),V=f(e=>e.activatePanel),y=f(e=>e.setRowToEdit),k=f(e=>e.setOptions),{columnTypes:n,isLoadingColumnTypes:D}=L(l),{deleteRow:R,updateRow:g}=Y(),x=m.useCallback(e=>{var T;const{http_status:r,urlslab_scr_timestamp:c,urlslab_sum_timestamp:d,scr_status:I}=(T=e==null?void 0:e.row)==null?void 0:T.original;return r>299||r<=0||I==="E"||!I?!1:c!==0||d!==0},[]),C=m.useCallback(e=>{const r=e==null?void 0:e.row.original,c=e==null?void 0:e.getValue();k([]),y({}),k([r.url_links_count>0&&{detailsOptions:{title:a("Outgoing links","urlslab"),text:`URL: ${r.url_name}`,slug:l,url:`${r.url_id}/links`,showKeys:[{name:["dest_url_name",a("Destination URL","urlslab")]}],listId:"dest_url_id",counter:c}},r.url_usage_cnt>0&&{detailsOptions:{title:a("Incoming links","urlslab"),text:`URL: ${r.url_name}`,slug:l,url:`${r.url_id}/linked-from`,showKeys:[{name:["src_url_name",a("Source URL","urlslab")]}],listId:"src_url_id",counter:c}},r.screenshot_usage_count>0&&{detailsOptions:{title:a("Screenshot used on Pages","urlslab"),slug:`${l}/screenshot`,url:`${r.url_id}/linked-from`,showKeys:[{name:["src_url_name",a("URL","urlslab")]}],listId:"src_url_id",counter:c}}])},[k,y,l]),$=m.useMemo(()=>({cell:e,onClick:r})=>{var d;const{http_status:c}=(d=e==null?void 0:e.row)==null?void 0:d.original;return c>0&&t.createElement(h,{title:a("Re-check status","urlslab"),arrow:!0,placement:"bottom"},t.createElement(b,{size:"xs",onClick:()=>r("-1")},t.createElement(E,{name:"refresh"})))},[]),H=m.useMemo(()=>({cell:e,onClick:r})=>{var d;const{scr_status:c}=(d=e==null?void 0:e.row)==null?void 0:d.original;return(c==="A"||c==="E"||c==="")&&t.createElement(h,{title:a("Request new Screenshot","urlslab"),arrow:!0,placement:"bottom"},t.createElement(b,{size:"xs",onClick:()=>r("N")},t.createElement(E,{name:"refresh"})))},[]),K=m.useMemo(()=>({cell:e,onClick:r})=>{var d;const{rel_schedule:c}=(d=e==null?void 0:e.row)==null?void 0:d.original;return(c==="A"||c==="E")&&t.createElement(h,{title:a("Update Related Articles","urlslab"),arrow:!0,placement:"bottom"},t.createElement(b,{size:"xs",onClick:()=>r("N")},t.createElement(E,{name:"refresh"})))},[]),Q=m.useMemo(()=>n?[s.accessor("check",{className:"checkbox",cell:e=>t.createElement(A,{tableElement:e}),header:e=>t.createElement(A,{tableElement:e})}),s.accessor("url_name",{tooltip:e=>e.row.original.screenshot_url_thumbnail?t.createElement(q,{component:"img",src:e.row.original.screenshot_url_thumbnail,alt:"url",sx:{borderRadius:"var(--urlslab-radius-sm)",display:"block",marginY:.25,maxWidth:"15em"}}):e.getValue(),cell:e=>t.createElement("a",{href:e.getValue(),target:"_blank",rel:"noreferrer"},e.getValue()),header:e=>t.createElement(i,{...e}),size:200}),s.accessor("url_title",{tooltip:e=>e.getValue(),header:e=>t.createElement(i,{...e}),size:120}),s.accessor("url_h1",{tooltip:e=>e.getValue(),header:_.url_h1,size:120}),s.accessor("url_meta_description",{tooltip:e=>e.getValue(),header:e=>t.createElement(i,{...e}),size:120}),s.accessor("url_summary",{tooltip:e=>e.getValue(),header:e=>t.createElement(i,{...e}),size:200}),s.accessor("visibility",{className:"nolimit",cell:e=>t.createElement(M,{defaultAccept:!0,autoClose:!0,items:n==null?void 0:n.visibility.values,name:e.column.id,value:e.getValue(),onChange:r=>g({newVal:r,cell:e})}),header:e=>t.createElement(i,{...e}),size:100}),s.accessor("url_priority",{className:"nolimit",cell:e=>t.createElement(v,{type:"number",value:e.getValue(),min:"0",max:"100",onChange:r=>g({newVal:r,cell:e})}),header:e=>t.createElement(i,{...e}),size:80}),s.accessor("url_links_count",{cell:e=>t.createElement(w,{direction:"row",alignItems:"center",spacing:1},t.createElement(t.Fragment,null,t.createElement("span",null,e==null?void 0:e.getValue()),(e==null?void 0:e.getValue())>0&&t.createElement(h,{title:a("Show URLs where used","urlslab"),arrow:!0,placement:"bottom"},t.createElement(b,{size:"xs",onClick:()=>{C(e),V(0)}},t.createElement(E,{name:"link"}))))),header:e=>t.createElement(i,{...e}),size:70}),s.accessor("url_usage_cnt",{cell:e=>t.createElement(w,{direction:"row",alignItems:"center",spacing:1},t.createElement(t.Fragment,null,t.createElement("span",null,e==null?void 0:e.getValue()),(e==null?void 0:e.getValue())>0&&t.createElement(h,{title:a("Show URLs where used","urlslab"),arrow:!0,placement:"bottom"},t.createElement(b,{size:"xs",onClick:()=>{C(e),V(1)}},t.createElement(E,{name:"link"}))))),header:e=>t.createElement(i,{...e}),size:70}),s.accessor("url_lang",{className:"nolimit",tooltip:e=>e.getValue(),cell:e=>X(e==null?void 0:e.getValue()),header:_.url_lang,size:110}),s.accessor("url_type",{cell:e=>t.createElement("span",null,n!=null&&n.url_type.values[e==null?void 0:e.getValue()]?n==null?void 0:n.url_type.values[e==null?void 0:e.getValue()]:e==null?void 0:e.getValue()),header:e=>t.createElement(i,{...e}),size:80}),s.accessor("http_status",{cell:e=>t.createElement(w,{direction:"row",alignItems:"center",spacing:1},t.createElement(t.Fragment,null,t.createElement($,{cell:e,onClick:r=>g({changeField:"http_status",newVal:r,cell:e})}),t.createElement("span",null,n!=null&&n.http_status.values[e==null?void 0:e.getValue()]?n==null?void 0:n.http_status.values[e==null?void 0:e.getValue()]:e==null?void 0:e.getValue()))),header:e=>t.createElement(i,{...e}),size:80}),s.accessor("content_type",{header:e=>t.createElement(i,{...e}),size:40}),s.accessor("update_http_date",{cell:e=>t.createElement(S,{datetime:e.getValue()}),header:e=>t.createElement(i,{...e}),size:115}),s.accessor("scr_status",{cell:e=>t.createElement(w,{direction:"row",alignItems:"center",spacing:1},t.createElement(t.Fragment,null,t.createElement("span",null,n==null?void 0:n.scr_status.values[e.getValue()]),t.createElement(H,{cell:e,onClick:r=>g({changeField:"scr_status",newVal:r,cell:e})}))),header:e=>t.createElement(i,{...e}),size:80}),s.accessor("update_scr_date",{cell:e=>t.createElement(S,{datetime:e.getValue()}),header:e=>t.createElement(i,{...e}),size:115}),s.accessor("screenshot_usage_count",{cell:e=>t.createElement(w,{direction:"row",alignItems:"center",spacing:1},t.createElement(t.Fragment,null,t.createElement("span",null,e==null?void 0:e.getValue()),(e==null?void 0:e.getValue())>0&&t.createElement(h,{title:a("Show pages where is screenshot used","urlslab")},t.createElement(b,{size:"xs",onClick:()=>{C(e),V(2)}},t.createElement(E,{name:"link"}))))),header:e=>t.createElement(i,{...e}),size:60}),s.accessor("sum_status",{cell:e=>n==null?void 0:n.sum_status.values[e.getValue()],header:e=>t.createElement(i,{...e}),size:80}),s.accessor("update_sum_date",{cell:e=>t.createElement(S,{datetime:e.getValue()}),header:e=>t.createElement(i,{...e}),size:115}),s.accessor("rel_schedule",{cell:e=>t.createElement(w,{direction:"row",alignItems:"center",spacing:1},t.createElement(t.Fragment,null,t.createElement("span",null,n==null?void 0:n.rel_schedule.values[e.getValue()]),t.createElement(K,{cell:e,onClick:r=>g({changeField:"rel_schedule",newVal:r,cell:e})}))),header:e=>t.createElement(i,{...e}),size:80}),s.accessor("rel_updated",{cell:e=>t.createElement(S,{datetime:e.getValue()}),header:e=>t.createElement(i,{...e}),size:115}),s.accessor("attributes",{cell:e=>e.getValue(),tooltip:e=>e.getValue(),header:e=>t.createElement(i,{...e}),size:40}),s.accessor("labels",{className:"nolimit",cell:e=>t.createElement(N,{value:e.getValue(),slug:l,onChange:r=>g({newVal:r,cell:e})}),header:_.labels,size:160}),s.accessor("editRow",{className:"editRow",cell:e=>{var r;return t.createElement(j,{onEdit:()=>g({cell:e,id:"url_name"}),onDelete:()=>R({cell:e,id:"url_name"})},x(e)&&t.createElement(G,{size:"xxs",onClick:()=>{k({changesPanel:{title:e.row.original.url_name,slug:`url/${e.row.original.url_id}/changes`}}),V("changesPanel")},sx:{mr:1}},a("Show changes","urlslab")),((r=e.row.original.edit_url_name)==null?void 0:r.length)>0&&t.createElement(h,{title:a("Edit Post","urlslab"),arrow:!0,placement:"bottom"},t.createElement(b,{size:"xs",component:"a",href:e.row.original.edit_url_name,target:"_blank"},t.createElement(E,{name:"edit-post"}))))},header:null,size:0})]:[],[V,s,n,R,k,C,x,l,g]);return m.useEffect(()=>{z(l,{data:u})},[u,z,l]),p||D?t.createElement(J,{isFullscreen:!0}):t.createElement(t.Fragment,null,t.createElement(Z,{title:a("About this table","urlslab"),tableSlug:l,isMainTableDescription:!0},a("The table displays the links found on your website during page generation. A background cron process evaluates these links for their accessibility to your site's visitors upon detection. This plugin offers features such as concealing all links that lead to invalid or non-existent URLs. Additionally, it provides a detailed overview of all internal and external links used on your website.","urlslab")),t.createElement(ee,{noImport:!0}),t.createElement(te,{className:"fadeInto",initialState:re,columns:Q,data:o&&O,referrer:B,loadingRows:P},t.createElement(ae,null)),t.createElement(le,{slug:l}))}const le=m.memo(({slug:l})=>{const s=f(o=>o.setRowToEdit),{columnTypes:u}=L(l),p=m.useMemo(()=>({url_title:t.createElement(v,{defaultValue:"",label:_.url_title,onChange:o=>s({url_title:o})}),url_meta_description:t.createElement(F,{rows:"5",description:"",liveUpdate:!0,defaultValue:"",label:_.url_meta_description,onChange:o=>s({url_meta_description:o})}),url_summary:t.createElement(F,{rows:"5",description:"",liveUpdate:!0,defaultValue:"",label:_.url_summary,onChange:o=>s({url_summary:o})}),labels:t.createElement(N,{optionItem:!0,label:a("Tags:","urlslab"),slug:l,onChange:o=>s({labels:o})}),visibility:t.createElement(M,{defaultAccept:!0,autoClose:!0,items:u==null?void 0:u.visibility.values,label:_.visibility,name:_.visibility,onChange:o=>s({visibility:o})}),url_priority:t.createElement(v,{type:"number",defaultValue:1,label:_.url_priority,min:"0",max:"100",onChange:o=>s({url_priority:o})})}),[u==null?void 0:u.visibility,s,l]);m.useEffect(()=>{f.setState(()=>({...f.getState(),rowEditorCells:p,deleteCSVCols:["urlslab_url_id","url_id","urlslab_domain_id"]}))},[p])});export{ue as default};
