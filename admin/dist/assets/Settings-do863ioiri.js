import{d as _,r as w,e as F,R as t,p as D,h as A,T as y,S as Q,f as j,g as N,i as z,j as H,B as U,k as V,I as W,s as g,_ as u,l as R,m as T,n as O,o as B,L as K,q as G}from"../main-do863ioiri.js";import{l as h}from"./labelsList-do863ioiri.js";import{M as J}from"./MultiSelectMenu-do863ioiri.js";const X=(m,d={})=>{const{queryClient:c}=d;switch(m){case"flowhunt-api-key":return c?()=>{c.invalidateQueries(["credits"]),c.invalidateQueries(["general"]),A()}:null;default:return null}};function Y({settingId:m,option:d}){const c=_(),{id:s,type:p,title:l,description:C,labels:n,placeholder:i,default:E,value:r,possible_values:$}=d,L=typeof r=="string"?new Date(r):new Date(r*1e3),[S,M]=w.useState(p!=="datetime"||L),[v,f]=w.useState(),b=X(s,{queryClient:c}),P=async()=>{g(s,{message:u("Executing…","urlslab"),status:"info"});const e=await R(r,{skipErrorHandling:!0}),a=await e.json();return e.ok?(g(s,{message:a==null?void 0:a.message,status:"success"}),!1):typeof a=="object"?(g(s,{message:a==null?void 0:a.message,status:"error"}),!1):(g(s,{message:e,status:"error"}),!1)},k=F({mutationFn:async e=>(f("active"),r.toString()!==e.toString()?(g(s,{message:`${u("Changing setting","urlslab")} ${l}…`,status:"info"}),{response:await T(`${m}/${s}`,{value:e},{skipErrorHandling:!0})}):{response:{}}),onSuccess:async({response:e})=>{const{ok:a}=e;if(a===void 0)return!1;if(a)return b&&typeof b=="function"&&b(),c.invalidateQueries(["settings",m]),f("success"),g(s,{message:`${u("Setting","urlslab")} ${l} ${u("changed!","urlslab")}`,status:"success"}),!1;f("error"),O(s,e,{title:`${u("Changing setting","urlslab")} ${l} ${u("failed","urlslab")}`})}}),q=F({mutationFn:async()=>(f("active"),g(s,{message:`${u("Changing date for","urlslab")} ${l}…`,status:"info"}),{response:await T(`${m}/${s}`,{value:S.getTime()/1e3},{skipErrorHandling:!0})}),onSuccess:async({response:e})=>{const{ok:a}=e;if(a)return b&&typeof b=="function"&&b(),f("success"),g(s,{message:`${u("Setting date for","urlslab")} ${l} ${u("changed!","urlslab")}`,status:"success"}),c.invalidateQueries(["settings",m]),!1;f("error"),O(s,e,{title:`${u("Changing date for","urlslab")} ${l} ${u("failed","urlslab")}`})}}),x=()=>{switch(p){case"text":case"password":case"number":return t.createElement(W,{key:s,type:p,title:l,label:t.createElement(t.Fragment,null,n.map(e=>{const{name:a,color:o}=h[e];return t.createElement(y,{key:e,size:"sm",color:o,isUppercase:!0,isOutlined:!0,fitText:!0,sx:{ml:1}},a)})),placeholder:i&&!r,defaultValue:r,onChange:e=>k.mutate(e)});case"textarea":return t.createElement(V,{key:s,type:p,title:l,label:t.createElement(t.Fragment,null,n.map(e=>{const{name:a,color:o}=h[e];return t.createElement(y,{key:e,size:"sm",color:o,isUppercase:!0,isOutlined:!0,fitText:!0,sx:{ml:1}},a)})),placeholder:i&&!r,defaultValue:r,onChange:e=>k.mutate(e)});case"api_button":return t.createElement(U,{key:s,onClick:P},l);case"checkbox":return t.createElement(H,{className:"option flex",key:s,title:l,label:t.createElement(t.Fragment,null,n.map(e=>{const{name:a,color:o}=h[e];return t.createElement(y,{key:e,size:"sm",color:o,isUppercase:!0,isOutlined:!0,fitText:!0,sx:{ml:1}},a)})),defaultValue:r,onChange:e=>k.mutate(e)});case"datetime":return t.createElement("div",{className:"urlslab-inputField-datetime"},t.createElement("div",{className:"urlslab-inputField-label"},l),t.createElement(j,{className:"urlslab-input xl",selected:S,key:s,dateFormat:N().datetime,timeFormat:N().time,calendarStartDay:window.wp.date.getSettings().l10n.startOfWeek,showTimeSelect:!0,onChange:e=>{const{origDate:a}=z(e);M(a),q.mutate()}}));case"listbox":return t.createElement(Q,{key:`${s}-${r}`,className:"wide",name:s,items:$,defaultValue:r,autoClose:!0,onChange:e=>k.mutate(e),labels:n.map(e=>{const{name:a,color:o}=h[e];return t.createElement(y,{key:e,size:"sm",color:o,isUppercase:!0,isOutlined:!0,fitText:!0,sx:{ml:1}},a)})},l);case"multicheck":return t.createElement(J,{className:"wide",items:$,defaultValue:r||E,key:s,id:s,asTags:!0,onChange:e=>k.mutate(e),labels:n.map(e=>{const{name:a,color:o}=h[e];return t.createElement(y,{key:e,size:"sm",color:o,isUppercase:!0,isOutlined:!0,fitText:!0,sx:{ml:1}},a)})},l)}};return t.createElement("div",{className:"urlslab-settingsPanel-option"},v!=="error"&&x(),v==="error"&&x(),t.createElement("p",{className:"urlslab-settingsPanel-option__desc",dangerouslySetInnerHTML:{__html:D(C.replaceAll(/\`(.+?)\`/g,'<span class="c-darker-saturated-red">$1</span>'))}}))}function te({className:m,settingId:d}){const c=_(),s=n=>{var i;document.querySelectorAll(".urlslab-settingsPanel-section").forEach(E=>E.classList.remove("active")),(i=n.target)==null||i.closest(".urlslab-settingsPanel-section").classList.add("active")},{data:p,status:l}=B({queryKey:["settings",d],queryFn:()=>G(d),initialData:()=>{if(d==="general")return c.getQueryData(["settings","general"])},refetchOnWindowFocus:!1,refetchOnMount:!0});if(l==="loading")return t.createElement(K,null);const C=p?Object.values(p):[];return t.createElement(t.Fragment,null,Object.values(C).map(n=>n.options?t.createElement("section",{onClick:s,className:`urlslab-settingsPanel-section ${m}`,key:n.id},t.createElement("div",{className:"urlslab-settingsPanel urlslab-panel flex-tablet-landscape"},t.createElement("div",{className:"urlslab-settingsPanel-desc"},t.createElement("h4",null,n.title),t.createElement("p",{dangerouslySetInnerHTML:{__html:D(n.description.replaceAll(/\`(.+?)\`/g,'<span class="c-darker-saturated-red">$1</span>'))}}),n.labels.map(i=>{const{name:E,color:r}=h[i];return t.createElement(y,{key:i,color:r,sx:{mr:1}},E)})),t.createElement("div",{className:"urlslab-settingsPanel-options"},Object.values(n.options).map(i=>t.createElement(Y,{settingId:d,option:i,key:`${i.id}-${i.value}`}))))):""))}export{te as default};
