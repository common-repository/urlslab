import{w as k,r as u,E as d,R as t,_ as s,x as L,N as M,y as B,z as S,V as i,S as U,ai as N,O,Q as P,U as A,aO as D,A as $,L as j,X as H,M as W,C as Y,Y as Q,ah as T}from"../main-do863ioiri.js";const z="fileid",x={filename:s("File name","urlslab"),url:s("Original URL","urlslab"),download_url:s("Offloaded URL","urlslab"),filetype:s("File type","urlslab"),filesize:s("File size","urlslab"),width:s("Width","urlslab"),height:s("Height","urlslab"),filestatus:s("Status","urlslab"),driver:s("Storage driver","urlslab"),usage_count:s("Usage","urlslab"),labels:s("Tags","urlslab")},q={columnVisibility:{width:!1,height:!1,labels:!1}};function J({slug:l}){const a=k(g=>g.setTable),[n,m]=u.useState(!1);return u.useEffect(()=>{m(!0),a(l,{paginationId:z,slug:l,header:x}),d.setState(()=>({deleteCSVCols:[z,"fileid","filehash"]}))},[a,l]),n&&t.createElement(K,{slug:l})}function K({slug:l}){const{columnHelper:a,data:n,isLoading:m,isSuccess:g,isFetchingNextPage:R,ref:y}=L({slug:l}),I=u.useMemo(()=>{var e;return(e=n==null?void 0:n.pages)==null?void 0:e.flatMap(r=>r??[])},[n==null?void 0:n.pages]),f=k(e=>e.setTable),p=d(e=>e.activatePanel),E=d(e=>e.setRowToEdit),h=d(e=>e.setOptions),{columnTypes:o,isLoadingColumnTypes:v}=M(l),{deleteRow:w,updateRow:b}=B(),V=u.useCallback(e=>{const r=e==null?void 0:e.row.original,c=e==null?void 0:e.getValue();h([]),E({}),r.usage_count>0&&h([{detailsOptions:{title:s("This file is used on the following URLs","urlslab"),slug:l,url:`${r.fileid}/urls`,showKeys:[{name:["url_name",s("URL","urlslab")]}],listId:"url_id",counter:c}}])},[h,E,l]),C=u.useMemo(()=>o?[a.accessor("check",{className:"checkbox",cell:e=>t.createElement(S,{tableElement:e}),header:e=>t.createElement(S,{tableElement:e})}),a.accessor("filename",{tooltip:e=>e.getValue(),header:e=>t.createElement(i,{...e}),size:200}),a.accessor("url",{tooltip:e=>{const r=()=>{const[c,_]=u.useState(!1),F=/(jpeg|jpg|webp|gif|png|svg|api\.urlslab\.com)/g;return e.getValue().search(F)!==-1?t.createElement(t.Fragment,null,t.createElement(T,{sx:{display:c?"none":"block"}},e.getValue()),t.createElement(T,{component:"img",src:e.getValue(),alt:"url",onLoad:()=>_(!0),sx:{borderRadius:"var(--urlslab-radius-sm)",display:c?"block":"none",marginY:.25,maxWidth:"15em"}})):e.getValue()};return t.createElement(r,null)},cell:e=>t.createElement("a",{href:e.getValue(),title:e.getValue(),target:"_blank",rel:"noreferrer"},e.getValue()),header:e=>t.createElement(i,{...e}),size:100}),a.accessor("download_url",{tooltip:e=>e.getValue(),cell:e=>t.createElement("a",{href:e.getValue(),title:e.getValue(),target:"_blank",rel:"noreferrer"},e.getValue()),header:e=>t.createElement(i,{...e}),size:100}),a.accessor("filetype",{header:e=>t.createElement(i,{...e}),size:80}),a.accessor("filesize",{tooltip:e=>e.getValue(),unit:"kB",cell:e=>`${Math.round(e.getValue()/1024,0)} kB`,header:e=>t.createElement(i,{...e}),size:50}),a.accessor("width",{unit:"px",cell:e=>`${e.getValue()} px`,header:e=>t.createElement(i,{...e}),size:50}),a.accessor("height",{unit:"px",cell:e=>`${e.getValue()} px`,header:e=>t.createElement(i,{...e}),size:50}),a.accessor("filestatus",{cell:e=>o==null?void 0:o.filestatus.values[e.getValue()],header:e=>t.createElement(i,{...e}),size:80}),a.accessor("driver",{className:"nolimit",cell:e=>t.createElement(U,{autoClose:!0,items:o==null?void 0:o.driver.values,name:e.column.id,value:e.getValue(),onChange:r=>b({newVal:r,customEndpoint:"/transfer",cell:e})}),header:e=>t.createElement(i,{...e}),size:100}),a.accessor("usage_count",{cell:e=>t.createElement(N,{direction:"row",alignItems:"center",spacing:1},t.createElement(t.Fragment,null,t.createElement("span",null,e==null?void 0:e.getValue()),(e==null?void 0:e.getValue())>0&&t.createElement(O,{title:s("Show URLs where used","urlslab"),arrow:!0,placement:"bottom"},t.createElement(P,{size:"xs",onClick:()=>{V(e),p(0)}},t.createElement(A,{name:"link"}))))),header:e=>t.createElement(i,{...e}),size:80}),a.accessor("labels",{className:"nolimit",cell:e=>t.createElement(D,{value:e.getValue(),slug:l,onChange:r=>b({newVal:r,cell:e})}),header:x.labels,size:150}),a.accessor("editRow",{className:"editRow",cell:e=>t.createElement($,{onDelete:()=>w({cell:e,id:"filename"})}),header:null,size:0})]:[],[p,a,o,w,V,l,b]);return u.useEffect(()=>{f(l,{data:n})},[n,f,l]),m||v?t.createElement(j,{isFullscreen:!0}):t.createElement(t.Fragment,null,t.createElement(H,{title:s("About this table","urlslab"),tableSlug:l,isMainTableDescription:!0},s("The table displays a list of all images and other media files found on your website. Images are added to this list through real-time processing as each page is displayed. All optimization tasks, such as generating WebP images, are performed on images identified and saved in this list during background cron jobs. Processing can take a few days. You can also track the usage of specific images. If an image is no longer present on your website, the plugin can automatically hide it to ensure sustained page quality.","urlslab")),t.createElement(W,{noImport:!0,hiddenFilters:["download_url"]}),t.createElement(Y,{className:"fadeInto",initialState:q,columns:C,data:g&&I,referrer:y,loadingRows:R},t.createElement(Q,null)))}export{J as default};
