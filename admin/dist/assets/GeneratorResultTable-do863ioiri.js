import{w as y,r as i,R as t,_ as n,x as N,E as d,N as A,y as L,O as E,Q as g,U as f,z as I,V as b,W,ai as U,aO as B,A as O,L as H,X as Q,M as $,C as j,Y as q,k as G,S as K}from"../main-do863ioiri.js";import{T as V}from"./TreeView-do863ioiri.js";const v="hash_id",p={shortcode_id:n("Shortcode ID","urlslab"),prompt_variables:n("Input data","urlslab"),result:n("Result","urlslab"),status:n("Status","urlslab"),date_changed:n("Last change","urlslab"),usage_count:n("Usage","urlslab"),labels:n("Tags","urlslab")},X={columnVisibility:{command:!1,labels:!1}};function te({slug:a}){const s=y(c=>c.setTable),[r,u]=i.useState(!1);return i.useEffect(()=>{u(!0),s(a,{paginationId:v,slug:a,header:p})},[s,a]),r&&t.createElement(Y,{slug:a})}function Y({slug:a}){const{columnHelper:s,data:r,isLoading:u,isSuccess:c,isFetchingNextPage:z,ref:D}=N({slug:a}),P=i.useMemo(()=>{var e;return(e=r==null?void 0:r.pages)==null?void 0:e.flatMap(o=>o??[])},[r==null?void 0:r.pages]),x=y(e=>e.setTable),C=d(e=>e.activatePanel),S=d(e=>e.setRowToEdit),w=d(e=>e.setOptions),{columnTypes:m,isLoadingColumnTypes:k}=A(a),{deleteRow:R,updateRow:h}=L(),T=i.useCallback(e=>{const o=e==null?void 0:e.row.original,l=e==null?void 0:e.getValue();w([]),S({}),h({cell:e}),o.usage_count>0&&w([{detailsOptions:{title:n("Shortcode used on these URLs","urlslab"),slug:a,counter:l,url:`${o.shortcode_id}/${o.hash_id}/urls`,showKeys:[{name:["url_name",n("URL","urlslab")]},{name:["created",n("Created","urlslab")]}],perPage:999,listId:"url_id"}}])},[w,S,a,h]),M=i.useMemo(()=>({cell:e,onClick:o})=>{var _;const{status:l}=(_=e==null?void 0:e.row)==null?void 0:_.original;return t.createElement("div",{className:"flex flex-align-center flex-justify-end"},(l==="W"||l==="D")&&t.createElement(E,{title:n("Accept","urlslab"),arrow:!0,placement:"bottom"},t.createElement(g,{size:"xs",color:"success",onClick:()=>o("A")},t.createElement(f,{name:"activate"}))),(l==="P"||l==="W"||l==="A"||l==="N")&&t.createElement(E,{title:n("Decline","urlslab"),arrow:!0,placement:"bottom"},t.createElement(g,{size:"xs",color:"danger",onClick:()=>o("D")},t.createElement(f,{name:"disable"}))),(l==="A"||l==="D"||l==="P")&&t.createElement(E,{title:n("Regenerate","urlslab"),arrow:!0,placement:"bottom"},t.createElement(g,{size:"xs",color:"neutral",onClick:()=>o("P")},t.createElement(f,{name:"refresh"}))))},[]),F=i.useMemo(()=>m?[s.accessor("check",{className:"checkbox",cell:e=>t.createElement(I,{tableElement:e}),header:e=>t.createElement(I,{tableElement:e})}),s.accessor("shortcode_id",{header:e=>t.createElement(b,{...e}),size:50}),s.accessor("prompt_variables",{cell:e=>t.createElement(V,{sourceData:e.getValue().replace(/\\u([0-9a-fA-F]{4})/g,o=>String.fromCharCode("0x"+o.slice(2))),isTableCellPopper:!0}),header:e=>t.createElement(b,{...e}),size:200}),s.accessor("result",{cell:e=>t.createElement(V,{sourceData:e.getValue(),isTableCellPopper:!0}),header:e=>t.createElement(b,{...e}),size:220}),s.accessor("status",{className:"nolimit",cell:e=>m==null?void 0:m.status.values[e.getValue()],header:e=>t.createElement(b,{...e}),size:60}),s.accessor("date_changed",{cell:e=>t.createElement(W,{datetime:e.getValue()}),header:e=>t.createElement(b,{...e}),size:115}),s.accessor("usage_count",{cell:e=>t.createElement(U,{direction:"row",alignItems:"center",spacing:1},t.createElement(t.Fragment,null,t.createElement("span",null,e==null?void 0:e.getValue()),(e==null?void 0:e.getValue())>0&&t.createElement(E,{title:n("Show URLs where used","urlslab"),arrow:!0,placement:"bottom"},t.createElement(g,{size:"xs",onClick:()=>{T(e),C(0)}},t.createElement(f,{name:"link"}))))),header:p.usage_count,size:60}),s.accessor("labels",{className:"nolimit",cell:e=>t.createElement(B,{value:e.getValue(),slug:a,onChange:o=>h({newVal:o,cell:e})}),header:p.labels,size:150}),s.accessor("editRow",{className:"editRow",cell:e=>t.createElement(O,{onEdit:()=>T(e),onDelete:()=>R({cell:e})},t.createElement(M,{cell:e,onClick:o=>h({changeField:"status",newVal:o,cell:e})})),header:null,size:0})]:[],[C,s,m,R,T,a,h]);return i.useEffect(()=>{x(a,{data:r})},[r,x,a]),u||k?t.createElement(H,{isFullscreen:!0}):t.createElement(t.Fragment,null,t.createElement(Q,{title:n("About this table","urlslab"),tableSlug:a,isMainTableDescription:!0},n("The table displays a list of texts that have already been produced by the AI generator shortcode. When the shortcode is placed on a specific page, it initiates an AI task. The text created by the AI generator is then stored in the result entry and subsequently presented on the page. The WordPress page does not directly contain the text; instead, it is incorporated into the page as it is generated. The page only includes the shortcode, which is then replaced with the actual text. The text generated by AI can be edited, approved, or declined to prevent the page from being spammed with inaccurate texts.","urlslab")),t.createElement($,{noImport:!0}),t.createElement(j,{className:"fadeInto",initialState:X,columns:F,data:c&&P,referrer:D,loadingRows:z},t.createElement(q,null)),t.createElement(J,{slug:a}))}const J=i.memo(({slug:a})=>{const{setRowToEdit:s}=d(),{columnTypes:r}=A(a),u=i.useMemo(()=>({result:t.createElement(G,{rows:"5",allowResize:!0,description:"",liveUpdate:!0,fullWidth:!0,fullHeight:!0,defaultValue:"",label:p.result,onChange:c=>s({result:c})}),status:t.createElement(K,{autoClose:!0,defaultAccept:!0,fullWidth:!0,description:"",items:r==null?void 0:r.status.values,name:"statusTypes",defaultValue:"W",onChange:c=>s({status:c})},p.status)}),[r==null?void 0:r.status,s]);i.useEffect(()=>{d.setState(()=>({...d.getState(),rowEditorCells:u,deleteCSVCols:[v,"hash_id"]}))},[u])});export{te as default};
