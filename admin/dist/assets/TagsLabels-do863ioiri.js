import{R as l,r as c,t as Y,v as J,I as q,B as L,w as V,_ as y,d as Z,x as G,y as ee,z as O,T as te,A as re,L as ne,M as oe,C as ae,E as F,o as le,l as se}from"../main-do863ioiri.js";import{M as K}from"./MultiSelectMenu-do863ioiri.js";/* empty css                            */function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function j(e,t){if(e==null)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t.indexOf(r=a[n])>=0||(o[r]=e[r]);return o}function D(e){var t=c.useRef(e),r=c.useRef(function(n){t.current&&t.current(n)});return t.current=e,r.current}var k=function(e,t,r){return t===void 0&&(t=0),r===void 0&&(r=1),e>r?r:e<t?t:e},x=function(e){return"touches"in e},R=function(e){return e&&e.ownerDocument.defaultView||self},P=function(e,t,r){var n=e.getBoundingClientRect(),o=x(t)?function(a,i){for(var s=0;s<a.length;s++)if(a[s].identifier===i)return a[s];return a[0]}(t.touches,r):t;return{left:k((o.pageX-(n.left+R(e).pageXOffset))/n.width),top:k((o.pageY-(n.top+R(e).pageYOffset))/n.height)}},z=function(e){!x(e)&&e.preventDefault()},Q=l.memo(function(e){var t=e.onMove,r=e.onKey,n=j(e,["onMove","onKey"]),o=c.useRef(null),a=D(t),i=D(r),s=c.useRef(null),d=c.useRef(!1),f=c.useMemo(function(){var _=function(h){z(h),(x(h)?h.touches.length>0:h.buttons>0)&&o.current?a(P(o.current,h,s.current)):m(!1)},u=function(){return m(!1)};function m(h){var g=d.current,C=R(o.current),w=h?C.addEventListener:C.removeEventListener;w(g?"touchmove":"mousemove",_),w(g?"touchend":"mouseup",u)}return[function(h){var g=h.nativeEvent,C=o.current;if(C&&(z(g),!function(W,X){return X&&!x(W)}(g,d.current)&&C)){if(x(g)){d.current=!0;var w=g.changedTouches||[];w.length&&(s.current=w[0].identifier)}C.focus(),a(P(C,g,s.current)),m(!0)}},function(h){var g=h.which||h.keyCode;g<37||g>40||(h.preventDefault(),i({left:g===39?.05:g===37?-.05:0,top:g===40?.05:g===38?-.05:0}))},m]},[i,a]),p=f[0],b=f[1],E=f[2];return c.useEffect(function(){return E},[E]),l.createElement("div",I({},n,{onTouchStart:p,onMouseDown:p,className:"react-colorful__interactive",ref:o,onKeyDown:b,tabIndex:0,role:"slider"}))}),S=function(e){return e.filter(Boolean).join(" ")},$=function(e){var t=e.color,r=e.left,n=e.top,o=n===void 0?.5:n,a=S(["react-colorful__pointer",e.className]);return l.createElement("div",{className:a,style:{top:100*o+"%",left:100*r+"%"}},l.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:t}}))},v=function(e,t,r){return t===void 0&&(t=0),r===void 0&&(r=Math.pow(10,t)),Math.round(r*e)/r},ue=function(e){return de(A(e))},A=function(e){return e[0]==="#"&&(e=e.substring(1)),e.length<6?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:e.length===4?v(parseInt(e[3]+e[3],16)/255,2):1}:{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4,6),16),a:e.length===8?v(parseInt(e.substring(6,8),16)/255,2):1}},ce=function(e){return me(fe(e))},ie=function(e){var t=e.s,r=e.v,n=e.a,o=(200-t)*r/100;return{h:v(e.h),s:v(o>0&&o<200?t*r/100/(o<=100?o:200-o)*100:0),l:v(o/2),a:v(n,2)}},B=function(e){var t=ie(e);return"hsl("+t.h+", "+t.s+"%, "+t.l+"%)"},fe=function(e){var t=e.h,r=e.s,n=e.v,o=e.a;t=t/360*6,r/=100,n/=100;var a=Math.floor(t),i=n*(1-r),s=n*(1-(t-a)*r),d=n*(1-(1-t+a)*r),f=a%6;return{r:v(255*[n,s,i,i,d,n][f]),g:v(255*[d,n,n,s,i,i][f]),b:v(255*[i,i,d,n,n,s][f]),a:v(o,2)}},N=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},me=function(e){var t=e.r,r=e.g,n=e.b,o=e.a,a=o<1?N(v(255*o)):"";return"#"+N(t)+N(r)+N(n)+a},de=function(e){var t=e.r,r=e.g,n=e.b,o=e.a,a=Math.max(t,r,n),i=a-Math.min(t,r,n),s=i?a===t?(r-n)/i:a===r?2+(n-t)/i:4+(t-r)/i:0;return{h:v(60*(s<0?s+6:s)),s:v(a?i/a*100:0),v:v(a/255*100),a:o}},he=l.memo(function(e){var t=e.hue,r=e.onChange,n=S(["react-colorful__hue",e.className]);return l.createElement("div",{className:n},l.createElement(Q,{onMove:function(o){r({h:360*o.left})},onKey:function(o){r({h:k(t+360*o.left,0,360)})},"aria-label":"Hue","aria-valuenow":v(t),"aria-valuemax":"360","aria-valuemin":"0"},l.createElement($,{className:"react-colorful__hue-pointer",left:t/360,color:B({h:t,s:100,v:100,a:1})})))}),ve=l.memo(function(e){var t=e.hsva,r=e.onChange,n={backgroundColor:B({h:t.h,s:100,v:100,a:1})};return l.createElement("div",{className:"react-colorful__saturation",style:n},l.createElement(Q,{onMove:function(o){r({s:100*o.left,v:100-100*o.top})},onKey:function(o){r({s:k(t.s+100*o.left,0,100),v:k(t.v-100*o.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+v(t.s)+"%, Brightness "+v(t.v)+"%"},l.createElement($,{className:"react-colorful__saturation-pointer",top:1-t.v/100,left:t.s/100,color:B(t)})))}),U=function(e,t){if(e===t)return!0;for(var r in e)if(e[r]!==t[r])return!1;return!0},ge=function(e,t){return e.toLowerCase()===t.toLowerCase()||U(A(e),A(t))};function pe(e,t,r){var n=D(r),o=c.useState(function(){return e.toHsva(t)}),a=o[0],i=o[1],s=c.useRef({color:t,hsva:a});c.useEffect(function(){if(!e.equal(t,s.current.color)){var f=e.toHsva(t);s.current={hsva:f,color:t},i(f)}},[t,e]),c.useEffect(function(){var f;U(a,s.current.hsva)||e.equal(f=e.fromHsva(a),s.current.color)||(s.current={hsva:a,color:f},n(f))},[a,e,n]);var d=c.useCallback(function(f){i(function(p){return Object.assign({},p,f)})},[]);return[a,d]}var be=typeof window<"u"?c.useLayoutEffect:c.useEffect,Ee=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},H=new Map,_e=function(e){be(function(){var t=e.current?e.current.ownerDocument:document;if(t!==void 0&&!H.has(t)){var r=t.createElement("style");r.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,H.set(t,r);var n=Ee();n&&r.setAttribute("nonce",n),t.head.appendChild(r)}},[])},Ce=function(e){var t=e.className,r=e.colorModel,n=e.color,o=n===void 0?r.defaultColor:n,a=e.onChange,i=j(e,["className","colorModel","color","onChange"]),s=c.useRef(null);_e(s);var d=pe(r,o,a),f=d[0],p=d[1],b=S(["react-colorful",t]);return l.createElement("div",I({},i,{ref:s,className:b}),l.createElement(ve,{hsva:f,onChange:p}),l.createElement(he,{hue:f.h,onChange:p,className:"react-colorful__last-control"}))},we={defaultColor:"000",toHsva:ue,fromHsva:function(e){return ce({h:e.h,s:e.s,v:e.v,a:1})},equal:ge},xe=function(e){return l.createElement(Ce,I({},e,{colorModel:we}))};function ye({defaultValue:e,label:t,className:r,onChange:n}){const{__:o}=Y(),a=["#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"],i=e||a[0],[s,d]=c.useState(i),f=c.useRef(),[p,b]=c.useState(!1),E=c.useCallback(()=>{b(!1),d(i)},[i]);J(f,E);const _=m=>{d(m)},u=()=>{b(!1),n(s)};return l.createElement("div",{className:`urlslab-colorPicker ${r||""}`},t?l.createElement("span",{className:"urlslab-inputField-label"},t):null,l.createElement("button",{className:"urlslab-colorPicker-activator",onClick:()=>b(!0)},l.createElement("div",{className:"urlslab-colorPicker-swatch mr-m",style:{backgroundColor:s}}),s),p&&l.createElement("div",{className:"urlslab-colorPicker-panel urslab-floating-panel urlslab-panel fadeInto onBottom",ref:f},l.createElement(xe,{color:s,onChange:_}),l.createElement(q,{className:"mt-m mb-m",liveUpdate:!0,key:s,autoFocus:!0,defaultValue:s,onChange:_}),l.createElement("span",{className:"fs-s c-grey-darker"},o("Predefined colors:","urlslab")),l.createElement("div",{className:"urlslab-colorPicker-swatches"},a.map(m=>l.createElement("button",{key:m,className:`urlslab-colorPicker-swatch__btn ${m===s?"active":""}`,onClick:()=>_(m)},l.createElement("div",{className:"urlslab-colorPicker-swatch",style:{background:m}})))),l.createElement("div",{className:"Buttons mt-m flex flex-align-center"},l.createElement(L,{variant:"plain",color:"neutral",onClick:()=>{d(i),b(!1)},sx:{ml:"auto",mr:1}},o("Cancel","urlslab")),l.createElement(L,{onClick:u},o("Apply","urlslab")))))}const ke=c.memo(ye),Me="label_id",T="label",Fe=y("Create new tag","urlslab"),M={name:y("Name","urlslab"),modules:y("Allowed modules","urlslab")},Ne={noScrollbar:!0,notWide:!0},Te=()=>le({queryKey:["label","modules"],queryFn:async()=>{const e=await se("label/modules");return e.ok?e.json():{}},refetchOnWindowFocus:!1});function Se(){const e=V(n=>n.setTable),[t,r]=c.useState(!1);return c.useEffect(()=>{r(!0),e(T,{title:Fe,paginationId:Me,slug:T,header:M,id:"name"})},[e]),t&&l.createElement(Ie,null)}function Ie(){const e=Z(),t=c.useRef({all:y("All Modules","urlslab")}),{data:r,isLoading:n}=Te();r&&Object.keys(r).length&&(t.current={...t.current,...r});const{columnHelper:o,data:a,isLoading:i,isSuccess:s}=G({slug:T},500),d=c.useMemo(()=>{var u;return(u=a==null?void 0:a.pages)==null?void 0:u.flatMap(m=>m??[])},[a==null?void 0:a.pages]),f=V(u=>u.setTable),p=c.useMemo(()=>{const u=()=>{e.refetchQueries({queryKey:["label","menu"]}),e.invalidateQueries({queryKey:["label","menu"]})};return{onEdit:u,onDelete:u,onInsert:u}},[e]),{deleteRow:b,updateRow:E}=ee({successCallbacks:p}),_=c.useMemo(()=>n||!(r&&Object.keys(r).length)?[]:[o.accessor("check",{className:"checkbox",cell:u=>l.createElement(O,{tableElement:u}),header:u=>l.createElement(O,{tableElement:u})}),o.accessor("name",{cell:u=>l.createElement("strong",null,u.getValue()),header:M.name,minSize:100}),o.accessor("name",{className:"nolimit",cell:u=>{var h;const m=(h=u==null?void 0:u.row)==null?void 0:h.original;return l.createElement(te,{color:m&&m.bgcolor?m.bgcolor:null,fitText:!0,thinFont:!0},u.getValue())},header:"Tag",size:100}),o.accessor("modules",{className:"nolimit",cell:u=>{var m;return l.createElement(K,{items:t.current,asTags:!0,id:`modules-${u.row.id}`,emptyAll:!0,value:(m=u.getValue())!=null&&m.length&&u.getValue()[0].length?u.getValue():[],onChange:h=>E({newVal:h,cell:u})})},header:M.modules,size:150}),o.accessor("editRow",{className:"editRow",cell:u=>l.createElement(re,{onEdit:()=>E({cell:u,id:"name"}),onDelete:()=>b({cell:u,id:"name"})}),header:null,size:0})],[o,b,n,r,E]);return c.useEffect(()=>{f(T,{data:a})},[a,f]),i||n?l.createElement(ne,{isFullscreen:!0}):l.createElement("div",{className:"urlslab-tableView"},l.createElement(oe,{noColumnsMenu:!0,noExport:!0,noImport:!0,noFiltering:!0,noCount:!0,options:Ne}),l.createElement(ae,{className:"fadeInto",columns:_,data:s&&d}),l.createElement(De,{possibleModules:t.current,changeRowSuccessCallbacks:p}))}const De=c.memo(({possibleModules:e,changeRowSuccessCallbacks:t})=>{const r=F(a=>a.rowToEdit),n=F(a=>a.setRowToEdit),o=c.useMemo(()=>({name:l.createElement(q,{liveUpdate:!0,autoFocus:!0,defaultValue:"",label:M.name,onChange:a=>n({...r,name:a}),required:!0}),bgcolor:l.createElement(ke,{defaultValue:"",label:y("Color","urlslab"),onChange:a=>n({...r,bgcolor:a})}),modules:l.createElement(K,{liveUpdate:!0,id:"modules",asTags:!0,items:e,defaultValue:[],emptyAll:!0,onChange:a=>n({...r,modules:a})},M.modules)}),[e,r,n]);c.useEffect(()=>{F.setState(()=>({...F.getState(),successCallbacks:t,rowEditorCells:{...o,modules:{...o.modules,props:{...o.modules.props,items:e}}}}))},[t,e,o])});export{Se as default};
