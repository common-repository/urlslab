import{w as y,r as u,bp as G,bq as W,br as $,R as t,_ as r,bn as O,x as J,bs as Z,E as h,N as ee,y as te,V as s,ag as A,W as M,aS as _,B as E,aO as ae,X as se,bv as le,L as re,C as ne,Y as oe,bx as ie,I as B,b as ue,A as ce,aM as me}from"../main-do863ioiri.js";import{T as ge}from"./TableFilters-do863ioiri.js";const de={competitors:r("Nr. Intersections","urlslab"),matching_urls:r("URL Intersections","urlslab"),my_min_pos:r("My best position","urlslab")},pe={...O,...de},g="serp-queries/query-cluster",ye=[{key:"competitors",dir:"DESC",op:"<"}],be={columnVisibility:{country:!1,type:!1,status:!1,updated:!1,comp_urls:!1,my_urls:!1,my_urls_ranked_top10:!1,my_urls_ranked_top100:!1,internal_links:!1,next_update_delay:!1,schedule:!1,labels:!1,country_level:!1,country_kd:!1,country_high_bid:!1,country_low_bid:!1}},Ee=[G,"serp-urls/url/queries","serp-gap"];function xe(){const a=y(i=>i.setTable),n=y(i=>i.queryDetailPanel),[c,b]=u.useState(!1),{query:o,country:m}=n;return u.useEffect(()=>{b(!0),a(g,{slug:g,header:pe,paginationId:"query_id",sorting:ye,relatedQueries:Ee,fetchOptions:{query:o,country:m,max_position:10,competitors:2},sourceTableInfo:{slug:G,optionalSelector:W,paginationId:$}})},[m,o,a]),c&&t.createElement(he,null)}const he=u.memo(()=>{const{columnHelper:a,data:n,isLoading:c,isSuccess:b,isFetchingNextPage:o,ref:m}=J({slug:g}),{compareUrls:i}=Z("query"),Q=u.useMemo(()=>{var e;return(e=n==null?void 0:n.pages)==null?void 0:e.flatMap(p=>p??[])},[n==null?void 0:n.pages]),f=y(e=>e.setTable),U=y(e=>e.queryDetailPanel),H=h(e=>e.activePanel),V=h(e=>e.activatePanel),x=h(e=>e.setRowToEdit),{country:d}=U,{columnTypes:l,isLoadingColumnTypes:K}=ee(g),{updateRow:w}=te(),C=u.useCallback((e,p=d)=>{y.setState({queryDetailPanel:{query:e,country:p,slug:e.replace(" ","-")}})},[d]),X=u.useMemo(()=>l?[a.accessor("query",{tooltip:e=>e.getValue(),cell:e=>t.createElement("strong",{className:"urlslab-serpPanel-keywords-item link-style",onClick:()=>C(e.row.original.query,e.row.original.country)},e.getValue()),header:e=>t.createElement(s,{...e}),size:100}),a.accessor("country",{cell:e=>t.createElement("strong",null,A[e.getValue()]?A[e.getValue()]:e.getValue()),header:e=>t.createElement(s,{...e}),minSize:130}),a.accessor("type",{className:"nolimit",tooltip:e=>l==null?void 0:l.type.values[e.getValue()],cell:e=>l==null?void 0:l.type.values[e.getValue()],header:e=>t.createElement(s,{...e}),size:80}),a.accessor("next_update_delay",{className:"nolimit",header:e=>t.createElement(s,{...e}),size:150}),a.accessor("status",{className:"nolimit",cell:e=>l==null?void 0:l.status.values[e.getValue()],header:e=>t.createElement(s,{...e}),size:100}),a.accessor("updated",{className:"nolimit",cell:e=>t.createElement(M,{datetime:e.getValue()}),header:e=>t.createElement(s,{...e}),size:40}),a.accessor("schedule",{className:"nolimit",cell:e=>t.createElement(M,{datetime:e.getValue()}),header:e=>t.createElement(s,{...e}),size:40}),a.accessor("comp_intersections",{className:"nolimit",cell:e=>e.getValue(),header:e=>t.createElement(s,{...e}),size:30}),a.accessor("matching_urls",{tooltip:e=>t.createElement(t.Fragment,null,_(e.getValue()),e.getValue().length>0&&t.createElement(E,{size:"xs",sx:{mt:1},onClick:()=>i({cell:e,country:d,urlsArray:e.getValue()})},r("Content Gap","urlslab"))),cell:e=>e.getValue(),header:e=>t.createElement(s,{...e}),size:100}),a.accessor("comp_urls",{tooltip:e=>t.createElement(t.Fragment,null,_(e.getValue()),e.getValue().length>0&&t.createElement(E,{size:"xs",sx:{mt:1},onClick:()=>i({cell:e,country:d,urlsArray:e.getValue()})},r("Content Gap","urlslab"))),cell:e=>e.getValue(),header:e=>t.createElement(s,{...e}),size:100}),a.accessor("my_urls",{tooltip:e=>t.createElement(t.Fragment,null,_(e.getValue()),e.getValue().length>0&&t.createElement(E,{size:"xs",sx:{mt:1},onClick:()=>i({cell:e,country:d,urlsArray:e.getValue()})},r("Content Gap","urlslab"))),cell:e=>e.getValue(),header:e=>t.createElement(s,{...e}),size:100}),a.accessor("my_min_pos",{cell:e=>e.getValue(),header:e=>t.createElement(s,{...e}),size:20}),a.accessor("competitors",{cell:e=>e.getValue(),header:e=>t.createElement(s,{...e}),size:20}),a.accessor("my_urls_ranked_top10",{className:"nolimit",cell:e=>e.getValue(),header:e=>t.createElement(s,{...e}),size:30}),a.accessor("my_urls_ranked_top100",{className:"nolimit",cell:e=>e.getValue(),header:e=>t.createElement(s,{...e}),size:30}),a.accessor("internal_links",{className:"nolimit",cell:e=>e.getValue(),header:e=>t.createElement(s,{...e}),size:30}),a.accessor("country_volume",{className:"nolimit",cell:e=>e.getValue()&&e.getValue()>0?e.getValue():"-",header:e=>t.createElement(s,{...e}),size:30}),a.accessor("country_kd",{className:"nolimit",cell:e=>e.getValue()&&e.getValue()>0?e.getValue():"-",header:e=>t.createElement(s,{...e}),size:30}),a.accessor("country_level",{className:"nolimit",cell:e=>l==null?void 0:l.country_level.values[e.getValue()],header:e=>t.createElement(s,{...e}),size:30}),a.accessor("intent",{className:"nolimit",cell:e=>l==null?void 0:l.intent.values[e.getValue()],header:e=>t.createElement(s,{...e}),size:30}),a.accessor("country_low_bid",{className:"nolimit",cell:e=>e.getValue()&&e.getValue()>0?e.getValue():"-",header:e=>t.createElement(s,{...e}),size:30}),a.accessor("country_high_bid",{className:"nolimit",cell:e=>e.getValue()&&e.getValue()>0?e.getValue():"-",header:e=>t.createElement(s,{...e}),size:30}),a.accessor("labels",{className:"nolimit",cell:e=>t.createElement(ae,{value:e.getValue(),slug:g,onChange:p=>w({newVal:p,cell:e})}),header:O.labels,size:100}),a.accessor("editRow",{className:"editRow",cell:e=>{const p=()=>{var z,k,N,v,S,q,P,T,I;const{data:Y,isSuccess:j}=ue();return t.createElement(ce,null,j&&Y.serp.active&&(((N=(k=(z=e==null?void 0:e.row)==null?void 0:z.original)==null?void 0:k.my_urls)==null?void 0:N.length)>0||((q=(S=(v=e==null?void 0:e.row)==null?void 0:v.original)==null?void 0:S.comp_urls)==null?void 0:q.length)>0||((I=(T=(P=e==null?void 0:e.row)==null?void 0:P.original)==null?void 0:T.matching_urls)==null?void 0:I.length)>0)&&t.createElement(E,{size:"xxs",onClick:()=>i({cell:e,country:d,urlsArray:[...e.row.original.my_urls,...e.row.original.comp_urls,...e.row.original.matching_urls]})},r("Content Gap","urlslab")),t.createElement(E,{component:me,to:"/KeywordsLinks/keyword",size:"xxs",onClick:()=>{var R,D,F,L;x({keyword:(D=(R=e==null?void 0:e.row)==null?void 0:R.original)==null?void 0:D.query,urlLink:(L=(F=e==null?void 0:e.row)==null?void 0:F.original)==null?void 0:L.my_urls[0]}),V("rowInserter")},sx:{mr:1}},r("Create Link","urlslab")))};return t.createElement(p,null)},header:null,size:0})]:[],[V,a,l,i,d,C,x,w]);return u.useEffect(()=>{f(g,{data:n})},[n,f]),t.createElement(t.Fragment,null,t.createElement(se,{title:r("About this table","urlslab"),tableSlug:g,sx:{mb:2}},r("It is list of similar queries identified by intersection of urls in top X results in Google search results. You can define your own intersection limits (e.g. min 3 urls from 10 or more strict 5 from 10). Basic idea behind the cluster is, that if Google ranked same urls for different keywords, those keywords are related and maybe you should cover all of them on single URL of your website.","urlslab")),t.createElement("div",{className:"urlslab-moduleView-headerBottom"},t.createElement(_e,null),t.createElement("div",{className:"flex flex-justify-space-between flex-align-center pb-s"},t.createElement(ge,null),t.createElement(le,{tableActions:{noImport:!0,noDelete:!0}}))),c||K?t.createElement(re,null):t.createElement(ne,{columns:X,initialState:be,data:b&&Q,referrer:m,loadingRows:o,disableAddNewTableRecord:!0},t.createElement(oe,null)),H==="export"&&t.createElement(ie,null))}),_e=u.memo(()=>{const a=y().useFetchOptions(),n=y(o=>o.setFetchOptions),[c,b]=u.useState({competitorCnt:a.competitors,maxPos:a.max_position});return t.createElement("div",{className:"flex flex-align-center mb-m"},t.createElement("div",null,t.createElement(B,{labelInline:!0,type:"number",liveUpdate:!0,defaultValue:c.competitorCnt,label:r("Clustering Level","urlslab"),onChange:o=>b(m=>({...m,competitorCnt:o}))})),t.createElement("div",{className:"ml-m"},t.createElement(B,{labelInline:!0,type:"number",liveUpdate:!0,defaultValue:c.maxPos,label:r("Maximum Position","urlslab"),onChange:o=>b(m=>({...m,maxPos:o}))})),t.createElement(E,{sx:{ml:1.5},onClick:()=>{n(g,{max_position:c.maxPos,competitors:c.competitorCnt})}},r("Update table","urlslab")))});export{xe as default};
